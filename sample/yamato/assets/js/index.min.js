$(document).ready(function(){

	//譎る俣陦ｨ遉ｺ
	$.clock($(".top-mvArea-clock span"));

	var cate_type = 'all';
	var hash = '';

	$('.topics_nav li').click(function(){
		hash = '';
		cate_type = $(this).data('type');
		$('.topics_nav li').removeClass('current');
		$(this).addClass('current');

		$('.list-topics-item').hide();
		$('.more_btn_area').hide();

		if(cate_type == 'all'){

			//螟ｧ逕ｻ蜒上�蟄伜惠繝√ぉ繝�け
			var view_count = 12;
			$('.list-topics-item').each(function(i) {
				if($(this).hasClass('list-topics-item-l')){
					view_count = 8;
					return true;
				}
			});

			$('.list-topics-item').each(function(i) {
				if(i <= view_count){
					$(this).delay(150 * i).fadeIn(1000);
				}
			});

			//繧ゅ▲縺ｨ隕九ｋ繝懊ち繝ｳ陦ｨ遉ｺ蛻､螳�
			if($('.list-topics-item.list-topics-item-s').length > view_count){
				$('.more_btn_area').delay(150 * (view_count + 1)).addClass('fade-up').fadeIn(1000);
			}

		} else {

			//螟ｧ逕ｻ蜒上�蟄伜惠繝√ぉ繝�け
			var view_count = 12;
			$('.'+cate_type).each(function(i) {
				if($(this).hasClass('list-topics-item-l')){
					view_count = 8;
					return true;
				}
			});

			var target_cnt = 0;
			$('.'+cate_type).each(function(i) {
				target_cnt++;
				if(i <= view_count){
					$(this).delay(150 * i).fadeIn(1000);
				}
			});

			//繧ゅ▲縺ｨ隕九ｋ繝懊ち繝ｳ陦ｨ遉ｺ蛻､螳�
			if($('.'+cate_type).length > view_count){
				$('.more_btn_area').delay(150 * (view_count + 1)).addClass('fade-up').fadeIn(1000);
			}
		}
	});

	$('.hashtag').click(function(){
		cate_type = '';
		hash = $(this).data('hash');
		$('.topics_nav li').removeClass('current');
		$('.list-topics-item').hide();
		$('.more_btn_area').hide();

		//螟ｧ逕ｻ蜒上�蟄伜惠繝√ぉ繝�け
		var view_count = 12;
		$('.'+hash).each(function(i) {
			if($(this).hasClass('list-topics-item-l')){
				view_count = 8;
				return true;
			}
		});

		var target_cnt = 0;
		$('.'+hash).each(function(i) {
			target_cnt++;
			if(i <= view_count){
				$(this).delay(150 * i).fadeIn(1000);
			}
		});

		//繧ゅ▲縺ｨ隕九ｋ繝懊ち繝ｳ陦ｨ遉ｺ蛻､螳�
		if(target_cnt > view_count){
			$('.more_btn_area').delay(150 * (view_count + 1)).addClass('fade-up').fadeIn(1000);
		}
	});

	$('.list-topics-btn').click(function(){

		$('.more_btn_area').hide();

		if(cate_type){
			if(cate_type == 'all'){
				var view_count = 8;
				var cnt = 0;
				var total_view_count = 0;
				$('.list-topics-item').each(function(i) {
					if(!$(this).is(':visible')){
						if(cnt < view_count){
							$(this).delay(150 * cnt).fadeIn(1000);
							cnt++;
						} else {
							return false;
						}
					}
					total_view_count++;
				});

				//繧ゅ▲縺ｨ隕九ｋ繝懊ち繝ｳ陦ｨ遉ｺ蛻､螳�
				if($('list-topics-item.list-topics-item-s').length > total_view_count){
					$('.more_btn_area').delay(150 * (cnt + 1)).addClass('fade-up').fadeIn(1000);
				}

			} else {
				var view_count = 8;
				var cnt = 0;
				var total_view_count = 0;
				$('.'+cate_type).each(function(i) {
					if(!$(this).is(':visible')){
						if(cnt < view_count){
							$(this).delay(150 * cnt).fadeIn(1000);
							cnt++;
						} else {
							return false;
						}
					}
					total_view_count++;
				});

				//繧ゅ▲縺ｨ隕九ｋ繝懊ち繝ｳ陦ｨ遉ｺ蛻､螳�
				if($('.'+cate_type).length > total_view_count){
					$('.more_btn_area').delay(150 * (cnt + 1)).addClass('fade-up').fadeIn(1000);
				}
			}
		} else {
			var view_count = 8;
			var cnt = 0;
			var total_view_count = 0;
			$('.'+hash).each(function(i) {
				if(!$(this).is(':visible')){
					if(cnt < view_count){
						$(this).delay(150 * cnt).fadeIn(1000);
						cnt++;
					} else {
						return false;
					}
				}
				total_view_count++;
			});

			//繧ゅ▲縺ｨ隕九ｋ繝懊ち繝ｳ陦ｨ遉ｺ蛻､螳�
			if($('.'+hash).length > total_view_count){
				$('.more_btn_area').delay(150 * (cnt + 1)).addClass('fade-up').fadeIn(1000);
			}
		}
	});

});

//fade縺ｮ險ｭ螳�
$(function(){

	var init_flag = true;

	$('.inview-top').stop().addClass('fade-in-bottom');

	$(window).scroll(function (){
		var scroll = $(window).scrollTop();
		var windowHeight = $(window).height();

		$(".inview").each(function(){
			var imgPos = $(this).offset().top;
			if (scroll > imgPos - windowHeight + windowHeight/3){
				$(this).addClass('fade-in-bottom');
			}
		});

		if (scroll > $('.top-topicsArea-list').offset().top - windowHeight + windowHeight/3){
			if(init_flag){
				$('.topics_nav li').eq(0).click();
				init_flag = false;
			}
		}
	});
});

$(document).ready(function(){
    var sliderVideo = $('.slider-wrapper').find('video').get(0);
    // 繧ｹ繝ｩ繧､繝繝ｼ
    var slider =  $('.slider-wrapper').bxSlider({
      mode: 'fade',
      auto: true,
      preloadimages: true,
      pause: 4000,
      speed: 800,
      touchEnabled: false,
      pagerType: 'full',
      prevText: '',
      nextText: '',
      useCSS: true,
      easing: 'ease-in',
      onSliderLoad: function(){
        sliderVideo.play();
        // 繧｢繧ｯ繝�ぅ繝悶�繝壹�繧ｸ繝｣繝ｼ縺ｫid繧剃ｻ倅ｸ�
        $('.bx-pager-link').each(function(i){
          $(this).empty();
          if ($(this).hasClass('active')){
            $(this).attr('id', 'activePager');
          } else {
            $(this).removeAttr('id');
          }
        });
        // 繝壹�繧ｸ繝｣繝ｼ縺ｫ繝励Ο繧ｰ繝ｬ繧ｹ繝舌�繧偵▽縺代ｋ
        var bar = new ProgressBar.Line(activePager, {
          strokeWidth: 2,
          easing: 'linear',
          duration: 4000,
          color: 'rgba( 226, 226, 226, 1 )',
          trailColor: 'rgba( 226, 226, 226, 0 )',
          trailWidth: 2,
          svgStyle: {width: '100%', height: '100%'}
        });
        bar.animate(1);
      },
      onSlideBefore: function(slideElement, oldIndex, newIndex){
        // h2繧偵ヵ繧ｧ繝ｼ繝峨う繝ｳ繝ｻ繝輔ぉ繝ｼ繝峨い繧ｦ繝�
        $('.top-mvArea-infoBox').each(function(i){
          $(this).removeClass('infoBox-old');
          $(this).removeClass('infoBox-new');
          if (i == oldIndex){
            $(this).addClass('infoBox-old');
          } else if(i == newIndex) {
            $(this).addClass('infoBox-new');
          }
        });
        $('.bx-pager-link').each(function(i){
          $(this).empty();
          if (i == newIndex){
            $(this).attr('id', 'activePager');
          } else {
            $(this).removeAttr('id');
          }
        });
        slider.stopAuto();
        slider.startAuto();
        var bar = new ProgressBar.Line(activePager, {
          strokeWidth: 2,
          easing: 'linear',
          duration: 4000,
          color: 'rgba( 226, 226, 226, 1 )',
          trailColor: 'rgba( 226, 226, 226, 0 )',
          trailWidth: 2,
          svgStyle: {width: '100%', height: '100%'}
        });
        bar.animate(1);
      },
      onSlideAfter: function(slideElement, oldIndex, newIndex){
        // 繝壹�繧ｸ繝ｭ繝ｼ繝画凾縺ｮ繧｢繝九Γ繝ｼ繧ｷ繝ｧ繝ｳ縺後せ繝ｩ繧､繝峨〒逋ｺ轣ｫ縺励↑縺�ｈ縺�け繝ｩ繧ｹ繧呈ｶ医☆
        if($('.top-mvArea-infoBox').hasClass('inview-top')){
          $('.top-mvArea-infoBox').removeClass('inview-top');
        };
      }
    });
    if( slider.getSlideCount() == 1 ) {
      // 繧ｹ繝ｩ繧､繝繝ｼ1縺､縺ｮ縺ｨ縺�
      slider.destroySlider();
    } else {
      $('.bx-pager').wrapAll('<div class="controls-tools"></div>');
      $('.bx-pager').before($('.bx-controls-auto'));
    }
    $(window).on('resize', function () {
      if($('.top-mvArea-infoBox').hasClass('inview-top')){
        $('.top-mvArea-infoBox').removeClass('inview-top');
      };
    });
});
$(function(){
  $('.popup-iframe').magnificPopup({
    type: 'iframe',
    mainClass: 'mfp-fade',
    removalDelay: 200,
    preloader: false
  });
});